From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: brickmonster <92665597+brickmonster@users.noreply.github.com>
Date: Sun, 14 Apr 2024 04:45:55 +0100
Subject: [PATCH] adventure: remove unnecessary copy


diff --git a/src/main/java/io/papermc/paper/adventure/ImprovedChatDecorator.java b/src/main/java/io/papermc/paper/adventure/ImprovedChatDecorator.java
index be232d09cafde0e47fa1a7b8bea6725f935d6ff6..6eb5cc9f6f117930e34583d81a4b1a4d0c652c11 100644
--- a/src/main/java/io/papermc/paper/adventure/ImprovedChatDecorator.java
+++ b/src/main/java/io/papermc/paper/adventure/ImprovedChatDecorator.java
@@ -34,18 +34,16 @@ public final class ImprovedChatDecorator implements ChatDecorator {
 
     private static CompletableFuture<Component> decorate(final MinecraftServer server, final @Nullable ServerPlayer player, final @Nullable CommandSourceStack commandSourceStack, final Component originalMessage) {
         return CompletableFuture.supplyAsync(() -> {
-            // Make a copy so that if the event if cancelled we can guarantee the original is being returned.
-            final net.kyori.adventure.text.Component originalMessageCopy = PaperAdventure.asAdventure(originalMessage.copy());
-            final net.kyori.adventure.text.Component initialResult = PaperAdventure.asAdventure(originalMessage.copy());
+            final net.kyori.adventure.text.Component initialResult = PaperAdventure.asAdventure(originalMessage);
 
             final @Nullable CraftPlayer craftPlayer = player == null ? null : player.getBukkitEntity();
 
             final AsyncChatDecorateEvent event;
             if (commandSourceStack != null) {
                 // TODO more command decorate context
-                event = new AsyncChatCommandDecorateEvent(true, craftPlayer, originalMessageCopy, initialResult);
+                event = new AsyncChatCommandDecorateEvent(true, craftPlayer, initialResult, initialResult);
             } else {
-                event = new AsyncChatDecorateEvent(true, craftPlayer, originalMessageCopy, initialResult);
+                event = new AsyncChatDecorateEvent(true, craftPlayer, initialResult, initialResult);
             }
 
             server.server.getPluginManager().callEvent(event);
